PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX dcat: <http://www.w3.org/ns/dcat#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX dgov: <http://data.gov.be#>

DELETE 
	{	?dataset dcat:distribution ?dist .
		?dist a dcat:Distribution .
		?dist dcterms:language ?lang .
		?dist dcterms:title ?title .
		?dist dcat:accessURL ?url }
INSERT 
	{ 	?dataset dcat:distribution ?newdist .
		?newdist a dcat:Distribution .
		?newdist dcterms:language ?lang .
		?newdist dcterms:title ?title .
		?newdist dcat:accessURL ?url .
		?newdist dgov:mediaType ?dgov .
		?newdist dcat:mediaType ?type .
		?newdist dcterms:format ?format }
WHERE
	{ 	?dataset dcat:distribution ?dist .
		?dist a dcat:Distribution .
		?dist dcterms:language ?lang .
		?dist dcterms:title ?title .
		?dist dcat:accessURL ?url
		VALUES (?dgov ?type ?format) {
			( <http://data.gov.be/en/taxonomy/term/1> "CSV" <http://publications.europa.eu/resource/authority/file-type/CSV> )
			( <http://data.gov.be/en/taxonomy/term/65> "PDF" <http://publications.europa.eu/resource/authority/file-type/PDF> )
			( <http://data.gov.be/en/taxonomy/term/247> "PNG" <http://publications.europa.eu/resource/authority/file-type/PNG> )
			( <http://data.gov.be/en/taxonomy/term/8> "XLS" <http://publications.europa.eu/resource/authority/file-type/XLS> )	
		}
		BIND ( IRI(CONCAT(STR(?dist), "/", ?type)) AS ?newdist )
	}